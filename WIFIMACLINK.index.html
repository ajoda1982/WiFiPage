<?php
// wifi-download.php
// Simple password-protect and serve file. Change $password to your chosen password.
$password = 'admin2k22';
$method = $_SERVER['REQUEST_METHOD'];

if ($method === 'POST') {
    $input = isset($_POST['pw']) ? $_POST['pw'] : '';
    if ($input === $password) {
        $file = __DIR__ . '/AllWiFi.mobileconfig';
        if (!file_exists($file)) {
            http_response_code(404);
            echo "File not found.";
            exit;
        }
        // Send appropriate headers for mobileconfig
        header('Content-Type: application/x-apple-aspen-config');
        header('Content-Disposition: attachment; filename="AllWiFi.mobileconfig"');
        header('Content-Length: ' . filesize($file));
        // Stream file
        readfile($file);
        exit;
    } else {
        http_response_code(403);
        echo "Incorrect password.";
        exit;
    }
}

// GET => show a simple HTML form to accept password
?>
<!doctype html>
<html>
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Wiâ€‘Fi Download</title></head>
<body style="font-family:Arial; text-align:center; padding:40px;">
  <h1>Enter IT password</h1>
  <form method="post" style="margin-top:18px;">
    <input type="password" name="pw" placeholder="IT password" style="padding:10px; width:70%;"><br>
    <button type="submit" style="margin-top:12px;padding:10px 18px;">Download</button>
  </form>
  <p style="margin-top:18px">Contact <a href="mailto:ajoda@stars-egypt.org">ajoda@stars-egypt.org</a> for help.</p>
</body>
</html>
